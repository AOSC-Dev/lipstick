Feature: Installing one applet from applet library

Prestate
- Home is running
- System has a mock installation source installed
- System has a mock package manager installed
- Mock installation source can provide five applets (in separate packages): Installable, UnInstallable, UnDownloadable, MetadataOnly, NonExistent
- Mock package can provide metadata of four packages: Installable, UnInstallable, UnDownloadable, MetadataOnly
- Metadata of all four packages state that package contains an applet and has no dependencies
- Mock package manager can initiate download of three packages: Installable, UnInstallable, UnDownloadable
- Mock package manager can initiate installation of two packages: Installable, UnInstallable


Test 1: "Show installation source"

Action 1: User opens applet library
Results:
- Applet library is shown with one installation source
- Installation source contains three applets: Installable, UnInstallable, UnDownloadable
  - UI Specified by Esa, graphics provided by Jorma


Test 2: "Install applet successfully"
Prerequisite: Test 1

Action 1: User selects Installable applet
Results:
- Applet library disappears, view returns to experience canvas
- On experience canvas there's an applet placeholder indicating download and install progress
  - UI Specified by Esa, graphics provided by Jorma
- Applet placeholder is updated to match the new download state
  - Clarify this from Esa and Jorma. If progress is indicated with spinning indicator this is not required
- Applet placeholder is updated to match the new state (from downloading to installing)
  - Clarify this from Esa and Jorma. If nothing is changed when progress moves from download to installing then this is not required
- Applet placeholder is updated to match the new installation state
  - Clarify this from Esa and Jorma. If progress is indicated with spinning indicator this is not required
- Applet contained in the installed package is instantiated and shown where installation placeholder used to be


Test 3: "Handle error in installation"
Prerequisite: Test 1

Action 1: User selects UnInstallable applet
Results:
- Applet library disappears
- View returns to experience canvas
- On experience canvas there's an applet placeholder indicating download and install progress
  - UI Specified by Esa, graphics provided by Jorma.
- Applet placeholder is updated to match the new download state
  - Clarify this from Esa and Jorma. If progress is indicated with spinning indicator this is not required
- Applet placeholder is updated to match the new state (from downloading to installing)
  - Clarify this from Esa and Jorma. If nothing is changed when progress moves from download to installing then this is not required
- Applet placeholder is updated to match the new installation state
  - Clarify this from Esa and Jorma. If progress is indicated with spinning indicator this is not required
- Indicate installation failure on applet placeholder
  - Clarify how the failure is indicated from Esa and Jorma

Action 2: User taps applet placeholder
Results:
- Show dialog that indicates that installation of applet has failed
- Show one option "Remove applet"
  - UI needs to be specified by Esa.
Action 3a: User selects "Remove applet" on the dialog
Results:
- Dialog is dismissed
- View goes back to experience canvas
- Applet placeholder is removed
  - UI needs to be specified by Esa
Action 3b: User selects "Cancel" on the dialog
Results:
- Dialog is dismissed
- View goes back to experience canvas
- Return to state before Action 2
  - UI needs to be specified by Esa.


Test 4: "Handle error during download"
Prerequisite: Test 1

Action 1: User selects UnDownloadable applet
Results:
- Applet library disappears
- View returns to experience canvas
- On experience canvas there's an applet placeholder indicating download and install progress
  - UI Specified by Esa, graphics provided by Jorma.
- Applet placeholder is updated to match the new download state
  - Clarify this from Esa and Jorma. If progress is indicated with spinning indicator this is not required
- Indicate download failure on applet placeholder
  - Clarify how the failure is indicated from Esa and Jorma
Action 2: User taps applet placeholder
Results:
- Show dialog that indicates that download of applet has failed
- Show one option "Remove applet"
  - UI needs to be specified by Esa
Action 3a: User selects "Remove applet" on the dialog
Results:
- Dialog is dismissed
- View goes back to experience canvas
- Applet placeholder is removed
  - UI needs to be specified by Esa
Action 3b: User selects "Cancel" on the dialog
Results:
- Dialog is dismissed
- View goes back to experience canvas
- Return to state before Action 2


Test 5: "Handle error when download starts"
Prerequisite: Test 1

Action 1: User selects MetadataOnly applet
Results:
- Applet library disappears
- View returns to experience canvas
- On experience canvas there's an applet placeholder indicating download and install progress
  - UI Specified by Esa, graphics provided by Jorma
- Indicate download failure on applet placeholder
  - Clarify how the failure is indicated from Esa and Jorma. Same behavior can be used when package manager cannot access repository (problems with credentials, etc.)
Action 2: User taps applet placeholder
Results:
- Show dialog that indicates that download of applet has failed
- Show one option "Remove applet"
  - UI needs to be specified by Esa
Action 3a: User selects "Remove applet" on the dialog
- Dialog is dismissed
- View goes back to experience canvas
- Applet placeholder is removed
  - UI needs to be specified by Esa.
Action 3b: User selects "Cancel" on the dialog
- Dialog is dismissed
- View goes back to experience canvas
- Return to state before Action 2


Test 6: "Selecting a non-existent applet"
Prerequisite: Test 1

Action 1: User selects NonExistent applet
Results:
- A dialog is shown which indicates that applet cannot be found
  - UI needs to be specified by Esa.
Actions 2: User dismisses dialog
- Dialog is dismissed
- View goes back to applet library
  - UI needs to be specified by Esa.
